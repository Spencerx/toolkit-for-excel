<!doctype html public "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<html>
<head>
<title>
 Overview
</title>
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="Style">
<script>
function asd() {
	
		parent.document.title="MarkLogicWordAddin.js Overview";
	
}
</script>
</head>
<body bgcolor="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> 	<font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top">
<em>
<b></b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<center>
	
	   <h2>MarkLogicWordAddin.js</h2>
	
</center>

	


<h4>Summary</h4>
<p>
	
		API documentation for MarkLogicWordAddin.js



 http://www.marklogic.com 

 <BR/><BR/><B>Version: </B>0.1<BR/><BR/><B>Author:</B> Pete Aven pete.aven@marklogic.com
 <BR/>
	
</p>

<hr>


    <table border="1" cellpadding="3" cellspacing="0" width="100%">
    <tr bgcolor="#CCCCFF" class="TableHeadingColor">
    <td colspan=2><font size="+2">
    
        <b>Class Summary</b>
    
    </font></td>
    </tr>
    
    <tr bgcolor="white" class="TableRowColor">
    <td width="15%"><b><a href="MLA.html">MLA</a></b></td>
    <td>&nbsp;</td>
    </tr>
    
    </table>
    <hr/> 


<!-- ========== METHOD SUMMARY =========== -->

<!-- ========== END METHOD SUMMARY =========== -->


        <pre class="sourceview"><span class="comment">//Copyright 2002-2008 Mark Logic Corporation.  All Rights Reserved.</span>
<span class="comment">/** 
 * <span class="attrib">@fileoverview</span>  API documentation for MarkLogicWordAddin.js
 *
 *
 *
 * {<span class="attrib">@link</span> http://www.marklogic.com} 
 *
 * <span class="attrib">@author</span> Pete Aven pete.aven<span class="attrib">@marklogic</span>.com
 * <span class="attrib">@version</span> 0.1 
 */</span>
<span class="comment">//Copyright 2002-2008 Mark Logic Corporation.  All Rights Reserved.</span>
<span class="comment">//var MLA = {};</span>


<span class="comment">/**
 * The MLA namespace is used for global attribution. The methods within this namespace provide ways of interacting with an Active OpenXML document through a WebBrowser control. The control must be deployed within an Addin in Office 2007.
 *
 * The methods here are mostly for Word; however, the functions getCustomPiece(), getCustomPieceIds(), addCustomPiece(), and deleteCustomPiece() will work for any Open XML package.
 * This object has methods for accessing an ActiveDocument in Word.
 */</span>
<span class="comment">//var MLA = {};</span>

<span class="reserved">function</span> MLA(){
      <span class="reserved">this</span>.getClassName = <span class="reserved">function</span>(){
      <span class="reserved">return</span> <span class="literal">"MLA"</span>;
   
      }
}

<span class="comment">/** <span class="attrib">@ignore</span> */</span>
MLA.version = { <span class="literal">"release"</span> : <span class="literal">"1.0-20081002"</span> }; 

<span class="comment">/** <span class="attrib">@ignore</span> */</span>
MLA.SimpleRange = <span class="reserved">function</span>(begin,finish){
	<span class="reserved">this</span>.start = begin;
	<span class="reserved">this</span>.end = finish;

};

<span class="comment">/** <span class="attrib">@ignore</span> */</span>
String.<span class="reserved">prototype</span>.trim = <span class="reserved">function</span>() {
	<span class="reserved">return</span> <span class="reserved">this</span>.replace(/^\s+|\s+$/g,<span class="literal">""</span>);
}


<span class="comment">/**
 * Returns version of MarkLogicWordAddin.js library
 * <span class="attrib">@return</span> the version of MarkLogicWordAddin.js
 * <span class="attrib">@type</span> String
 */</span>
MLA.getVersion = <span class="reserved">function</span>()
{
	<span class="reserved">return</span> MLA.version.release;
}

<span class="comment">/** <span class="attrib">@ignore</span> */</span>
MLA.errorCheck = <span class="reserved">function</span>(message)
{
	var returnVal = null;
        var errStr = message.substring(0,6);
	var len = message.length;
        var errMsg = message.substring(7,len);

        <span class="reserved">if</span>(errStr==<span class="literal">"error:"</span>)
		returnVal=errMsg;

	<span class="reserved">return</span> returnVal;

}
<span class="comment">/** Utility function for creating Microsoft.XMLDOM object from string
 *
 *<span class="attrib">@param</span> xmlString the string to be loaded into a XMLDOM object.  The string must be serialized, well-formed XML.
 *<span class="attrib">@param</span> asynch sets asynchronous property of object
 *<span class="attrib">@return</span> Microsoft.XMLDOM object
 *<span class="attrib">@throws</span> Exception if unable to create the XMLDOM object
 */</span>
MLA.getXMLDOMFromString = <span class="reserved">function</span>(xmlstring,asynch)
{
   var xmlDom = new ActiveXObject(<span class="literal">"Microsoft.XMLDOM"</span>);
       xmlDom.async=asynch;
       xmlDom.loadXML(xmlstring);
   <span class="reserved">return</span> xmlDom;
}

<span class="comment">/** Utility function to create a default WordprocessingML paragraph &lt;w:p&gt;, with no styles, for a given string.
 *
 *<span class="attrib">@param</span> textstring the string to be converted into a WordprocessingML paragraph
 *<span class="attrib">@return</span> Microsoft.XMLDOM object that is a WordprocessingML paragraph
 *<span class="attrib">@throws</span> Exception if unable to create the paragraph
 */</span>
MLA.createParagraph = <span class="reserved">function</span>(textstring)
{
	var newParagraphString = <span class="literal">"&lt;w:p xmlns:w='http://schemas.openxmlformats.org/wordprocessingml/2006/main'&gt;&lt;w:r&gt;&lt;w:t&gt;"</span>+
		                    textstring+
			         <span class="literal">"&lt;/w:t&gt;&lt;/w:r&gt;&lt;/w:p&gt;"</span>;
	var newPara = MLA.getXMLDOMFromString(newParagraphString,false);
	<span class="reserved">return</span> newPara;
}
<span class="comment">/** Inserts text into the ActiveDocument at current cursor position.  Text will be styled according to whatever is the currently chosen style for text within Word. 
 *<span class="attrib">@param</span> textToInsert the text to be inserted at the current cursor position in the ActiveDocument.
 *<span class="attrib">@throws</span> Exception if unable to insert text 
 */</span>
MLA.insertText = <span class="reserved">function</span>(textToInsert)
{
	var textAdded = window.external.insertText(textToInsert);
	var errMsg = MLA.errorCheck(textAdded);
	<span class="reserved">if</span>(errMsg!=null)
	   throw(<span class="literal">"Error: Not able to insert text "</span>+errMsg);
     
	<span class="reserved">if</span>(textAdded==<span class="literal">""</span>)
	  textAdded = null;
}
<span class="comment">/**
 * Returns the text currently highlighted in the ActiveDocument. If nothing is selected, null is returned. 
 * <span class="attrib">@returns</span> text currently highlighted in ActiveDocument as string
 * <span class="attrib">@type</span> String
 */</span>
MLA.getSelectionText = <span class="reserved">function</span>()
{
	var selText = window.external.getSelectionText();
	var errMsg = MLA.errorCheck(selText);
	<span class="reserved">if</span>(errMsg!=null)
	   throw(<span class="literal">"Error: Not able to get selection text "</span>+errMsg);
     
	<span class="reserved">if</span>(selText==<span class="literal">""</span>)
	  selText = null;

	<span class="reserved">return</span> selText;
}
<span class="comment">/**
 * Returns ids for custom pieces (not built-in) that are part of the active OpenXML package. (.docx, .xlsx, .pptx, etc.)
 * <span class="attrib">@returns</span> the ids for custom pieces in active OpenXML package as array of string
 * <span class="attrib">@type</span> Array 
 */</span>
MLA.getCustomPieceIds = <span class="reserved">function</span>()
{ 
	var pieces = window.external.getCustomPieceIds();

	var errMsg = MLA.errorCheck(pieces);
	<span class="reserved">if</span>(errMsg!=null)
	  throw(<span class="literal">"Error: Not able to get CustomPieceIds; "</span>+errMsg);

	var customPieces = pieces.split(<span class="literal">" "</span>);
	<span class="reserved">return</span> customPieces;
}

<span class="comment">/**
 * Returns the custom piece, identified by customPieceId, that is part of the active OpenXML package. (.docx, .xlsx, .pptx, etc.)
 * <span class="attrib">@param</span> customPieceId the id of the custom piece to be fetched from the active package
 * <span class="attrib">@return</span> the XML for the custom piece as a DOM object. 
 * <span class="attrib">@type</span> Microsoft.XMLDOM object 
 * <span class="attrib">@throws</span> Exception if there is error retrieving the custom piece 
 */</span>
MLA.getCustomPiece = <span class="reserved">function</span>(customPieceId)
{
	var customPiece = window.external.getCustomPiece(customPieceId);

	var errMsg = MLA.errorCheck(customPiece);
	<span class="reserved">if</span>(errMsg!=null)
	   throw(<span class="literal">"Error: Not able to getCustomPiece; "</span>+errMsg);

	<span class="reserved">if</span>(customPiece==<span class="literal">""</span>)
	  customPiece=null;

        var v_cp = MLA.getXMLDOMFromString(customPiece); 

	<span class="reserved">return</span> v_cp;
}

<span class="comment">/** Adds custom piece to active OpenXML package.  Returns the id of the piece added.
 *<span class="attrib">@param</span> customPieceXML Either A) an XMLDOM object that is the custom piece to be added to the active Open XML package, or B)The string serialization of the XML to be added as a custom piece to the active Open XML package. ( The XML must be well-formed. )
 *<span class="attrib">@return</span> id for custom piece added 
 *<span class="attrib">@type</span> String
 *<span class="attrib">@throws</span> Exception if unable to add custom piece
 */</span>
MLA.addCustomPiece = <span class="reserved">function</span>(customPieceXml)
{
	var v_customPiece =<span class="literal">""</span>;
	<span class="reserved">if</span>(customPieceXml.xml)
	{
               v_customPiece=customPieceXml.xml;
	}
	<span class="reserved">else</span>
	{
	       v_customPiece=customPieceXml
	}
	
	var newId = window.external.addCustomPiece(v_customPiece);

	var errMsg = MLA.errorCheck(newId);
	<span class="reserved">if</span>(errMsg!=null)
	   throw(<span class="literal">"Error: Not able to addCustomPiece; "</span>+errMsg);

	<span class="reserved">if</span>(newId ==<span class="literal">""</span>)
	  newId=null;

	<span class="reserved">return</span> newId;
}

<span class="comment">/** Deletes custom piece from Active OpenXML package identified by id.
 *<span class="attrib">@param</span> customPieceId the id of the custom piece to be deleted from the active OpenXML package.
 *<span class="attrib">@throws</span> Exception if unable to add custom piece
 */</span>
MLA.deleteCustomPiece = <span class="reserved">function</span>(customPieceId)
{
	var deletedPiece = window.external.deleteCustomPiece(customPieceId);

        var errMsg = MLA.errorCheck(deletedPiece);
	<span class="reserved">if</span>(errMsg!=null)
	   throw(<span class="literal">"Error: Not able to deleteCustomPiece; "</span>+errMsg);
     
	<span class="reserved">if</span>(deletedPiece==<span class="literal">""</span>)
	  deletedPiece = null;

}



<span class="comment">/*
MLA.getSelection = function()
{
	var selection = window.external.getSelection();

        var errStr = selection.substring(0,6);
	var len = selection.length;
        var errMsg = selection.substring(7,len);

	if(errStr == "error:")
   	   throw("Unable to getSelection: "+errMsg);

	var selections;
        if(selections == "")
	{
	   selections=null;
	}
	else
	{
	   selections = selection.split("U+016000");
	}

	return selections;
}
*/</span>

<span class="comment">/** Returns the XML that represents what is currently selected (highlighted) by the user in the ActiveDocument as an XMLDOM object.  Whatever is highlighted by the user will be returned in this function as a block level element.  A user may highlight text that will be materialized as multiple sibling block elements in the XML.  For this reason, the function returns an array, where each element of the array is an XMLDOM object that contains the XML for the blocks highlighted by the user in the ActiveDocument.  The order of elements in the array represents the order of items that are highlighted in the ActiveDocument.
 *<span class="attrib">@return</span> the blocks of XML currently selected by the user in the ActiveDocument as XMLDOM objects. If nothing is selected, an empty array is returned.
 *<span class="attrib">@type</span> Array
 *<span class="attrib">@throws</span> Exception if unable to retrieve the Selection
*/</span>
MLA.getSelection = <span class="reserved">function</span>()
{
	var arrCount=0;
	var selCount =0;
	var selections = new Array();
	var domSelections = new Array();
        
	var selection =  window.external.getSelection(selCount);

	var err = false;
	var errMsg = MLA.errorCheck(selection);
	<span class="reserved">if</span>(errMsg!=null)
	{
		err=true;
		selection=<span class="literal">""</span>;
	}


	selections[arrCount]=selection;

	<span class="reserved">while</span>(selection!=<span class="literal">""</span>)
	{
  	  selCount++;
          arrCount++;
	  selection = window.external.getSelection(selCount);


	  var errMsg = MLA.errorCheck(selection);
	  <span class="reserved">if</span>(errMsg!=null){
   	    err=true;
	    selection=<span class="literal">""</span>;
	  }

	  <span class="reserved">if</span>(selection!=<span class="literal">""</span>)
	      selections[arrCount] = selection;

	}

	<span class="reserved">if</span>(err==true)
	{
	   throw(<span class="literal">"Error: Not able to getSelection; "</span>+errMsg);
	}



	<span class="reserved">for</span>(i=0;i&lt;selections.length;i++)
	{
         	domSelections[i] = MLA.getXMLDOMFromString(selections[i]);
	}

	<span class="reserved">return</span> domSelections;
}

<span class="comment">/** Returns the final XML block that represents the Sentence at the current cursor position.  Nothing is required to be highlighted in the ActiveDocument.  If a selection is highlighted, this returns the XML for the Sentence immediately preceding the cursor.  If there is no selection, the XML for the sentence immediately preceding the cursor position is still returned. 
 *<span class="attrib">@return</span> the block of XML, as XMLDOM object,  for the Sentence immediately preceding the cursor position.
 *<span class="attrib">@type</span> Microsoft.XMLDOM object
 *<span class="attrib">@throws</span> Exception if unable to retrieve the XML for the Sentence.
*/</span>
MLA.getSentenceAtCursor = <span class="reserved">function</span>()
{
	var rangeXml = window.external.getSentenceAtCursor();

	var errMsg = MLA.errorCheck(rangeXml);
	<span class="reserved">if</span>(errMsg!=null) 
	   throw(<span class="literal">"Error: Not able to get Sentence at Cursor; "</span>+errMsg);

	var v_rangeXml = MLA.getXMLDOMFromString(rangeXml);
	<span class="reserved">return</span> v_rangeXml;
}

<span class="comment">/** Returns the Styles.xml for the ActiveDocument as XMLDOM object. 
 * <span class="attrib">@return</span> Styles.xml if no Styles.xml present in ActiveDocument package, returns null.
 * <span class="attrib">@type</span> Microsoft.XMLDOM object
 *<span class="attrib">@throws</span> Exception if unable to retrieve Styles.xml from the ActiveDocument.
 */</span>
MLA.getActiveDocStylesXml = <span class="reserved">function</span>()
{ 
	var stylesXml = window.external.getActiveDocStylesXml();

        var errMsg = MLA.errorCheck(stylesXml);
	<span class="reserved">if</span>(errMsg!=null)
	   throw(<span class="literal">"Error: Not able to getActiveDocStylesXml; "</span>+errMsg);

	<span class="reserved">if</span>(stylesXml==<span class="literal">""</span>)
          stylesXml=null;

	var v_stylesXml = MLA.getXMLDOMFromString(stylesXml);
	<span class="reserved">return</span> v_stylesXml;
}

<span class="comment">/** <span class="attrib">@ignore</span> */</span>
MLA.isArray = <span class="reserved">function</span>(obj)
{
 <span class="reserved">return</span> obj.constructor == Array;
}

<span class="comment">/** Inserts block-level xml into the ActiveDocument in Word at the current cursor position, or over the selected range (if selected).  If stylesxml parameter is defined, the blockxml will be inserted and the Styles.xml will be overwritten with the stylesxml contents. If stylesxml is not defined, then only the blockxml will be inserted ; the assumption being that whatever styles required by the blockxml are already present in the .docx Styles.xml.
 *
 * There are two main levels of content in the document.xml; block-level and inline content. Block level describes the structure of the document, and includes paragraphs and tables. Anything that can be inserted under &lt;w:body&gt; may be inserted here
 * 
 *<span class="attrib">@param</span> blockXml this parameter may either be A) and XMLDOM object that is the block-level XML to be inserted,or an array of such objects,or B) a String, that is the serialized, well-formed XML of the block to be inserted, or an Array of such Strings.
 *<span class="attrib">@param</span> stylesXml (optional) this parameter is either A) an XMLDOM object that contains Styles.xml for the pacakge, or B)a String, which is the serialized, well-formed XML that represents Styles.xml for the ActiveDocument package in Word.
 *<span class="attrib">@throws</span> Exception if unable to insert the blockContent or Styles.xml
 */</span>
MLA.insertBlockContent = <span class="reserved">function</span>(blockContentXml,stylesXml)
{
	<span class="reserved">if</span>(stylesXml == null) 
	    stylesXml = <span class="literal">""</span>;
  
       
	var v_block=<span class="literal">""</span>;
	var v_styles=<span class="literal">""</span>;

	<span class="reserved">if</span>(blockContentXml.xml)
	{
               v_block=blockContentXml.xml;
	}
	<span class="reserved">else</span>
	{
	  var v_array = MLA.isArray(blockContentXml);

	  <span class="reserved">if</span>(v_array)
	  {
		<span class="reserved">for</span>(var i=0;i&lt;blockContentXml.length;i++)
		{
			v_block = v_block+blockContentXml[i];
		}
	  }
	  <span class="reserved">else</span>
	  {
		v_block = blockContentXml;
	  }
	}

	<span class="reserved">if</span>(stylesXml.xml)
	{
             v_styles=stylesXml.xml;
	}
	<span class="reserved">else</span>
	{
             v_styles=stylesXml;
	}
	
        var inserted = window.external.insertBlockContent(v_block,v_styles);

	var errMsg = MLA.errorCheck(inserted);
	<span class="reserved">if</span>(errMsg!=null)
	   throw(<span class="literal">"Error: Not able to insertBlockContent; "</span>+errMsg);

	<span class="reserved">if</span>(inserted==<span class="literal">""</span>)
	  inserted = null;

}

<span class="comment">/**
 *
 *Returns MLA.config. The fields for this object are version, url, and theme.  
version - the version of the Addin library, url - the url used by the Addin WebBrowser control, theme - the current color of Office. 
 *<span class="attrib">@throws</span> Exception if unable to create MLA.config object
 */</span>
MLA.getConfiguration = <span class="reserved">function</span>()
{
        var version = window.external.getAddinVersion();
	var color = window.external.getOfficeColor();
	var webUrl = window.external.getBrowserURL();

	<span class="reserved">if</span>(version == <span class="literal">""</span> || color == <span class="literal">""</span> || webUrl == <span class="literal">""</span>)
		throw(<span class="literal">"Error: Not able to access configuration info."</span>);

	MLA.config = {
		        <span class="literal">"version"</span>:version,
			<span class="literal">"url"</span>:webUrl,
			<span class="literal">"theme"</span>:color
	};

        <span class="reserved">return</span> MLA.config;	
}

<span class="comment">//FOLLOWING ARE NOT OFFICIALLY SANCTIONED, USE AT OWN RISK, THEY MAY CHANGE/BE REMOVED </span>
<span class="comment">/** <span class="attrib">@ignore</span> */</span>
MLA.getRangesForTerm = <span class="reserved">function</span>(searchText)
{
       var ranges = window.external.getRangesForTerm(searchText);

       var errMsg = MLA.errorCheck(ranges);
       <span class="reserved">if</span>(errMsg!=null)
	   throw(<span class="literal">"Error: Not able to get ranges for text; "</span>+errMsg);

       <span class="comment">//alert("RANGES" +ranges);</span>
       var rngArray = new Array(); 
       var tmpArray = ranges.split(<span class="literal">" "</span>);
       <span class="comment">//alert("TMP ARRAY LENGTH"+tmpArray.length);</span>

       <span class="reserved">if</span>(tmpArray[0].length &gt;1 )
       {	
         <span class="reserved">for</span>(var i=0;i&lt;tmpArray.length;i++)
         {
            var pieces = tmpArray[i].split(<span class="literal">":"</span>);
   	    var finRng = new MLA.SimpleRange(pieces[0],pieces[1]);
	    rngArray[i]=finRng;
	    <span class="comment">//alert("pieces "+pieces[0]+" OSLO "+pieces[1]); </span>
         }
       }

	<span class="reserved">return</span> rngArray;

}
<span class="comment">/** <span class="attrib">@ignore</span> */</span>
MLA.getRangeForSelection = <span class="reserved">function</span>()
{
   var sel = window.external.getRangeForSelection();
   var finRng=null;
   var errMsg = MLA.errorCheck(sel);
       <span class="reserved">if</span>(errMsg!=null)
	   throw(<span class="literal">"Error: Not able to get ranges for text; "</span>+errMsg);

   var pieces = sel.split(<span class="literal">":"</span>);

   <span class="reserved">if</span>(pieces.length==2)
        finRng = new MLA.SimpleRange(pieces[0],pieces[1]);

   <span class="reserved">return</span> finRng;

}
<span class="comment">/** <span class="attrib">@ignore</span> */</span>
MLA.addCommentToRange = <span class="reserved">function</span>(ranges,commentText)
{
	<span class="reserved">if</span>(ranges.length &gt; 0)
	{

	  var stringRange=<span class="literal">""</span>;
	  <span class="reserved">for</span>(var i=0;i&lt;ranges.length;i++)
	  {
		<span class="comment">// alert("TESTIN LOOP");</span>
		 var x = new MLA.SimpleRange(0,0);
		 x=ranges[i];
		 stringRange = stringRange+x.start+<span class="literal">":"</span>+x.end+<span class="literal">" "</span>;


	  }
		 stringRange = stringRange.trim();
	  <span class="comment">//alert("RANGE: "+stringRange+" : END TEST");</span>
	 var commentsAdded =  window.external.addCommentToRange(stringRange, commentText);

	 var errMsg = MLA.errorCheck(commentsAdded);
         <span class="reserved">if</span>(errMsg!=null)
	   throw(<span class="literal">"Error: Not able to add comments to ranges; "</span>+errMsg)

	}
}
<span class="comment">/** <span class="attrib">@ignore</span> */</span>
MLA.addContentControlToRange = <span class="reserved">function</span>(ranges,title,tag,lockstatus)
{
	<span class="reserved">if</span>(ranges.length &gt; 0)
	{

	  var stringRange=<span class="literal">""</span>;
	  <span class="reserved">for</span>(var i=0;i&lt;ranges.length;i++)
	  {
		<span class="comment">// alert("TESTIN LOOP");</span>
		 var x = new MLA.SimpleRange(0,0);
		 x=ranges[i];
		 stringRange = stringRange+x.start+<span class="literal">":"</span>+x.end+<span class="literal">" "</span>;


	  }
		 stringRange = stringRange.trim();
	  <span class="comment">//alert("RANGE: "+stringRange+" : END TEST");</span>
	 var controlsAdded =  window.external.addContentControlToRange(stringRange, title,tag,lockstatus);

	 var errMsg = MLA.errorCheck(controlsAdded);
         <span class="reserved">if</span>(errMsg!=null)
	   throw(<span class="literal">"Error: Not able to add comments to ranges; "</span>+errMsg)

	}
}
<span class="comment">/** <span class="attrib">@ignore</span> */</span>
MLA.addCommentForText = <span class="reserved">function</span>(searchText, commentText)
{
	var commentAdded = window.external.addCommentForText(searchText, commentText);

        var errMsg = MLA.errorCheck(commentAdded);
	<span class="reserved">if</span>(errMsg!=null)
	   throw(<span class="literal">"Error: Not able to add Comment for text "</span>+errMsg);
     
	<span class="reserved">if</span>(commentAdded==<span class="literal">""</span>)
	  commentAdded = null;
}
<span class="comment">/** <span class="attrib">@ignore</span> */</span>
MLA.addContentControlForText = <span class="reserved">function</span>(searchTerm, ccTitle, ccTag,lockStatus)
{
	var controlAdded = window.external.addContentControlForText(searchTerm, ccTitle, ccTag,lockStatus);
	var errMsg = MLA.errorCheck(controlAdded);
	<span class="reserved">if</span>(errMsg!=null)
	   throw(<span class="literal">"Error: Not able to insert text "</span>+errMsg);
     
	<span class="reserved">if</span>(controlAdded==<span class="literal">""</span>)
	  controlAdded = null;
}

<span class="comment">//USE WITH CAUTION - IF EMBEDDED CONTROL, PARENT CONTROL WILL LOSE ITS TEXT, AS IT WAS IN THIS CHILD - UNDER CONSTRUCTION ...</span>
<span class="comment">/** <span class="attrib">@ignore</span> */</span>
MLA.deleteContentControl = <span class="reserved">function</span>()
{
	window.external.deleteContentControl();
}

<span class="comment">/** <span class="attrib">@ignore</span> */</span>
MLA.insertTextInControl = <span class="reserved">function</span>(textToInsert,tagName,isLocked)
{
	var textAdded = window.external.insertTextInControl(textToInsert,tagName,isLocked);
	var errMsg = MLA.errorCheck(textAdded);
	<span class="reserved">if</span>(errMsg!=null)
	   throw(<span class="literal">"Error: Not able to insert text "</span>+errMsg);
     
	<span class="reserved">if</span>(textAdded==<span class="literal">""</span>)
	  textAdded = null;
}
<span class="comment">/** <span class="attrib">@ignore</span> */</span>
MLA.addContentControlToSelection = <span class="reserved">function</span>(tagName, isLocked)
{
        var sdtAdded = window.external.addContentControlToSelection(tagName,isLocked);
	var errMsg = MLA.errorCheck(sdtAdded);
	<span class="reserved">if</span>(errMsg!=null)
	   throw(<span class="literal">"Error: Not able to insert text "</span>+errMsg);
     
	<span class="reserved">if</span>(sdtAdded==<span class="literal">""</span>)
	  sdtAdded = null;

}


</pre>
	<hr>



<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> <font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top"><em>
<b></b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<font size="-1">

</font>
<div class="jsdoc_ctime">Documentation generated by <a href="http://jsdoc.sourceforge.net/" target="_parent">JSDoc</a> on Fri Oct  3 10:52:31 2008</div>
</body>
</html>
